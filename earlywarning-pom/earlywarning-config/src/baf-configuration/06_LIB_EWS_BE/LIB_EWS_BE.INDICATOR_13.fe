VAR formulaName = "[LIB_EWS_BE.INDICATOR_13.fe] ";
DEBUGMESSAGE(formulaName, "START");

VAR sql = "";

sql = "CASE WHEN COUNTRY = 'BIB' AND REGULAMENTARY_SEGMENT = 'Corporate' THEN 6058.6855
        WHEN COUNTRY = 'BIB' AND REGULAMENTARY_SEGMENT = 'Retail' THEN 145.21431
        ELSE NULL
END AS MISSING_VALUE_IND_13,

48.1689 AS CORPORATE_VAL_MIN_IND_13,
221617.1 AS CORPORATE_VAL_MAX_IND_13,
29135.72 AS RETAIL_VAL_MAX_IND_13,

CASE
	WHEN ACCOUNT_BALANCE_M0 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M1 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M2 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M3 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M4 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M5 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M6 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M7 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M8 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M9 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M10 IS NULL THEN MISSING_VALUE_IND_13
	WHEN ACCOUNT_BALANCE_M11 IS NULL THEN MISSING_VALUE_IND_13
	ELSE(ACCOUNT_BALANCE_M0+ACCOUNT_BALANCE_M1+ACCOUNT_BALANCE_M2+ACCOUNT_BALANCE_M3+ACCOUNT_BALANCE_M4+ACCOUNT_BALANCE_M5+ACCOUNT_BALANCE_M6+ACCOUNT_BALANCE_M7+ACCOUNT_BALANCE_M8+ACCOUNT_BALANCE_M9+ACCOUNT_BALANCE_M10+ACCOUNT_BALANCE_M11)/12
END AS IND_13_TMP,

CASE
                WHEN (REGULAMENTARY_SEGMENT = 'Corporate' AND IND_13_TMP > CORPORATE_VAL_MAX_IND_13) THEN CORPORATE_VAL_MAX_IND_13
				WHEN (REGULAMENTARY_SEGMENT = 'Corporate' AND IND_13_TMP < CORPORATE_VAL_MIN_IND_13) THEN CORPORATE_VAL_MIN_IND_13
                WHEN (REGULAMENTARY_SEGMENT = 'Retail' AND IND_13_TMP > RETAIL_VAL_MAX_IND_13) THEN RETAIL_VAL_MAX_IND_13
                ELSE IND_13_TMP
END AS IND_13,

(CASE
	WHEN ACCOUNT_BALANCE_M0 IS NULL 
	OR
	ACCOUNT_BALANCE_M1 IS NULL
	OR
	ACCOUNT_BALANCE_M2 IS NULL
	OR
	ACCOUNT_BALANCE_M3 IS NULL 
	OR
	ACCOUNT_BALANCE_M4 IS NULL 
	OR
	ACCOUNT_BALANCE_M5 IS NULL 
	OR
	ACCOUNT_BALANCE_M6 IS NULL 
	OR
	ACCOUNT_BALANCE_M7 IS NULL 
	OR
	ACCOUNT_BALANCE_M8 IS NULL 
	OR
	ACCOUNT_BALANCE_M9 IS NULL 
	OR
	ACCOUNT_BALANCE_M10 IS NULL 
	OR
	ACCOUNT_BALANCE_M11 IS NULL THEN 'E0001; ' ELSE ''
	
	END)||
CASE
				
                WHEN (REGULAMENTARY_SEGMENT = 'Corporate' AND IND_13_TMP > CORPORATE_VAL_MAX_IND_13) THEN 'E0002'
				WHEN (REGULAMENTARY_SEGMENT = 'Corporate' AND IND_13_TMP < CORPORATE_VAL_MIN_IND_13) THEN 'E0002'
                WHEN (REGULAMENTARY_SEGMENT = 'Retail' AND IND_13_TMP > RETAIL_VAL_MAX_IND_13) THEN 'E0002'
				ELSE ''
END AS ERROR_MSG_IND_13";


DEBUGMESSAGE(formulaName, sql);
DEBUGMESSAGE(formulaName, "END");

return sql;
