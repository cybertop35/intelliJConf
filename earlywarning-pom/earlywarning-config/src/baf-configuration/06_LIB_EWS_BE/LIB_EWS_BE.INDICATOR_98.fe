VAR formulaName = "[LIB_EWS_BE.INDICATOR_98.fe] ";
DEBUGMESSAGE(formulaName, "START");

VAR sql = "";

sql = "
CASE
                WHEN ((TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1) <> 0 AND (TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1) IS NOT NULL
					AND (TOTAL_ASSETS_Y0-TOTAL_LIABILITIES_Y0-INTANGIBLE_ASSETS_Y0) IS NOT NULL) THEN ((TOTAL_ASSETS_Y0-TOTAL_LIABILITIES_Y0-INTANGIBLE_ASSETS_Y0) / ((TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1)))
                WHEN ((TOTAL_ASSETS_Y0-TOTAL_LIABILITIES_Y0-INTANGIBLE_ASSETS_Y0) IS NULL) THEN 0
                WHEN ((TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1) = 0) THEN 0
                WHEN ((TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1) IS NULL) THEN 0
END AS IND_98,

CASE 
                WHEN ((TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1) <> 0 AND (TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1)
				IS NOT NULL AND (TOTAL_ASSETS_Y0-TOTAL_LIABILITIES_Y0-INTANGIBLE_ASSETS_Y0) IS NOT NULL) THEN ''
                WHEN ((TOTAL_ASSETS_Y0-TOTAL_LIABILITIES_Y0-INTANGIBLE_ASSETS_Y0) IS NULL) THEN 'ERROR; '
                WHEN ((TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1) = 0) THEN 'ERROR; '
                WHEN ((TOTAL_ASSETS_Y1-TOTAL_LIABILITIES_Y1-INTANGIBLE_ASSETS_Y1) IS NULL) THEN 'ERROR; ' 
END AS ERROR_MSG_IND_98";


DEBUGMESSAGE(formulaName, sql);
DEBUGMESSAGE(formulaName, "END");

return sql;
